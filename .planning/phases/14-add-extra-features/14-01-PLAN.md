# Phase 14: Add Extra Features

**Status:** Planned
**Goal:** Integrate external tools to enhance the Sincronizado development experience
**Depends on:** Phase 13 (v1.0.0 Release)

---

## Background

Post-MVP enhancements evaluated from external ecosystem. Focus on tools that:
1. Improve multi-session workflow
2. Enable seamless context handoffs
3. Add visibility into AI interactions
4. Provide isolated development environments

---

## Tool Evaluation Summary

### Already Integrated (Phase 2)
| Tool | Purpose |
|------|---------|
| agent-os | Web UI for mobile access |
| agentmap | Tree view navigation |
| opencode-direnv | Environment variable management |
| opencode-sync | GitHub Gist sync |
| ccmanager | Session management |
| ai-sessions-mcp | History search |

### Evaluated for Phase 14

#### 1. opencode-session-handoff
**Repo:** bristena-op/opencode-session-handoff (4 stars)
**Recommendation:** HIGH PRIORITY

**What it does:**
- Seamless context handoffs when sessions fill up
- Say "handoff" -> creates new session with compact continuation prompt
- Critical for mobile/multi-device workflow

**Install:**
```json
// opencode.json
{ "plugin": ["opencode-session-handoff"] }
```

**Effort:** Trivial (single config line)
**Value:** HIGH - prevents lost context on long sessions

---

#### 2. ccmanager (Enhanced)
**Repo:** kbwo/ccmanager (797 stars, v3.6.4)
**Recommendation:** ALREADY INTEGRATED - Review for updates

**What it does:**
- Multi-AI session manager (Claude, Gemini, Codex, OpenCode)
- Visual status indicators (busy/waiting/idle)
- Git worktree integration with session data copying
- Multi-project mode
- Auto-approval (experimental)
- Devcontainer support
- Status change hooks for automation

**Install:**
```bash
npm install -g ccmanager
```

**Update in setup-vps.sh:** Already present, ensure version pinned

---

#### 3. agent-of-empires
**Repo:** njbrake/agent-of-empires (514 stars)
**Recommendation:** MEDIUM PRIORITY

**What it does:**
- TUI/CLI session manager using tmux + git worktrees
- Auto-creates worktrees per session
- Status dashboard
- Docker sandboxing option
- First-class OpenCode support with status detection

**Install:**
```bash
curl -fsSL https://raw.githubusercontent.com/.../install.sh | bash
# or: brew install agent-of-empires
```

**When to use:** Multi-session power users running 2+ parallel agents
**Effort:** Low (curl install + config)
**Value:** MEDIUM - overlaps with ccmanager

---

#### 4. lunaroute
**Repo:** erans/lunaroute (127 stars, Rust)
**Recommendation:** LOW PRIORITY

**What it does:**
- High-performance local proxy for AI coding assistants
- Zero-overhead passthrough (<0.5ms)
- Session recording (SQLite + JSONL)
- Token usage tracking
- PII redaction
- Prometheus metrics
- Web UI at port 8082

**Install:**
```bash
curl -fsSL https://github.com/.../releases/latest/download/lunaroute-linux-amd64 -o lunaroute
chmod +x lunaroute && sudo mv lunaroute /usr/local/bin/
eval $(lunaroute-server env)
```

**When to use:** Need visibility into AI interactions, cost tracking, debugging
**Effort:** Medium (binary install + env config)
**Value:** LOW for basic use, HIGH for debugging/cost analysis

---

#### 5. code-on-incus
**Repo:** mensfeld/code-on-incus (72 stars, Go)
**Recommendation:** LOW PRIORITY (overkill for single user)

**What it does:**
- Isolated Incus containers for AI coding
- Multi-slot support for parallel sessions
- Session resume with full history
- UID mapping (no permission hell)
- Network isolation
- macOS support via Colima/Lima

**Install:**
```bash
curl -fsSL https://raw.githubusercontent.com/.../install.sh | bash
coi build  # 5-10 minutes
coi shell
```

**When to use:** Need strict isolation, security-focused environments
**Effort:** High (Incus setup required)
**Value:** LOW for typical use, HIGH for security-critical

---

#### 6. opencode-worktree-session
**Repo:** felixAnhalt/opencode-worktree-session (11 stars)
**Recommendation:** MEDIUM PRIORITY

**What it does:**
- Automatic Git worktree per OpenCode session
- Isolated environment for every task
- Auto-commits changes on exit
- Cleanup on session end
- Refuses to run on main branch (safety)

**Install:**
```json
// opencode.json
{ "plugin": ["@tmegit/opencode-worktree-session"] }
```

**When to use:** Want isolated git branches per task
**Effort:** Trivial (npm package)
**Value:** MEDIUM - clean git history per feature

---

#### 7. kimaki
**Repo:** remorses/kimaki (306 stars, v0.4.52)
**Recommendation:** HIGH PRIORITY

**What it does:**
- Discord bot to control OpenCode agents
- Each project = Discord channel
- Each session = Discord thread
- Voice message support (transcription via Gemini)
- File attachments included in context
- Session resume/fork/share
- CI integration (`kimaki send` for GitHub Actions)
- Multi-machine support (one bot per VPS)

**Install:**
```bash
npx -y kimaki@latest
# Interactive setup wizard handles Discord bot creation
```

**Architecture:**
- SQLite database in `~/.kimaki/`
- Spawns OpenCode servers per project
- Channel topic contains XML metadata linking to directory

**Why HIGH PRIORITY:**
- Perfect complement to Agent-OS for mobile access
- Discord app is already on every phone
- Voice messages = truly hands-free coding from mobile
- CI integration enables GitHub issue -> AI investigation

**Effort:** Medium (Discord bot setup + config)
**Value:** HIGH - transforms mobile workflow

---

## Implementation Plan

### Phase 14.1: Session Handoff (HIGH)
**Effort:** 0.5h

- [ ] Add opencode-session-handoff to setup-vps.sh
- [ ] Document handoff workflow in mobile access guide
- [ ] Test handoff between devices

### Phase 14.2: Kimaki Discord Bot (HIGH)
**Effort:** 1.5h

- [ ] Add kimaki to setup-vps.sh (npm install)
- [ ] Create systemd service for kimaki daemon
- [ ] Document Discord bot setup in mobile access guide
- [ ] Document CI integration for GitHub Actions
- [ ] Add voice message workflow documentation

### Phase 14.3: Worktree Sessions (MEDIUM)
**Effort:** 1h

- [ ] Add opencode-worktree-session to setup-vps.sh
- [ ] Document worktree workflow
- [ ] Add to workflow documentation

### Phase 14.4: Agent of Empires (OPTIONAL)
**Effort:** 1h

- [ ] Add installation option to setup-vps.sh (commented by default)
- [ ] Document as alternative to ccmanager
- [ ] Create comparison guide

### Phase 14.5: LunaRoute (OPTIONAL)
**Effort:** 2h

- [ ] Add installation option to setup-vps.sh (commented by default)
- [ ] Document for debugging/cost analysis use case
- [ ] Add to troubleshooting guide

---

## Success Criteria

- [ ] Session handoff works seamlessly between desktop/mobile
- [ ] Kimaki Discord bot running as systemd service
- [ ] Voice messages from Discord trigger AI sessions
- [ ] Worktree isolation prevents main branch pollution
- [ ] Documentation updated for new features
- [ ] All optional tools documented with use cases

---

## Not Implementing

| Tool | Reason |
|------|--------|
| code-on-incus | Overkill for single-user VPS setup |
| agent-sessions (Swift) | macOS desktop only, not relevant for VPS |
| opencode-smart-title | Nice-to-have, not critical |

---

## Estimated Effort

| Task | Time |
|------|------|
| Phase 14.1: Session Handoff | 0.5h |
| Phase 14.2: Kimaki Discord Bot | 1.5h |
| Phase 14.3: Worktree Sessions | 1h |
| Phase 14.4: Agent of Empires (optional) | 1h |
| Phase 14.5: LunaRoute (optional) | 2h |
| **Total Required** | **3h** |
| **Total with Optional** | **6h** |

---

## Open Questions

1. Should agent-of-empires replace ccmanager or coexist?
2. LunaRoute worth adding to default install or keep as optional?
3. Kimaki: run as systemd service or manual start?
4. Discord bot token storage: env var or config file?
